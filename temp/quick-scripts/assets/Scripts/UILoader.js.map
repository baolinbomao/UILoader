{"version":3,"sources":["UILoader.js"],"names":["initRetain","texture","retain","initSceneRetain","undefined","parserPrefab","node","number","children","_children","forEach","child","parserPrefabNode","sprite","getComponent","cc","Sprite","spriteFrame","loader","_cache","_textureFilename","button","Button","normalSprite","pressedSprite","hoverSprite","disabledSprite","label","Label","font","BitmapFont","richText","RichText","imageAtlas","keys","Object","_spriteFrames","length","particleSystem","ParticleSystem","_texture","pageViewIndicator","PageViewIndicator","editBox","EditBox","backgroundImage","mask","Mask","parseStaticRes","item","tag","Texture2D","url","isStatic","cusTag","SpriteFrame","Prefab","parseStaticPrefab","SpriteAtlas","key","AnimationClip","log","name","prefab","data","Scene","parseStaticNode","_isNullObj","deepCloneObj","obj","i","o","Array","isArray","hasOwnProperty","releaseNodeRes","dependAssets","director","getScene","texturesInCache","release_key","asset","push","release","releaseRes","release_json","dependKeys","is_release","indexOf","releaseStaticRes","replaceButtonTexture","target","newNormalSprite","key_map","audioPath","UILoader","loadRes","path","type","callback","err","loadStaticRes","retainScene","scene","replaceSpriteTexture","instantiate","node_prefab","addChild","destroy","Node","beforeSceneLoading","event","detail","currentTarget","_scene","afterSceneLaunch","playEffect","volume","audioID","audioEngine","play","setFinishCallback","ss","ss11","src","playMusic","loop","module","exports"],"mappings":"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","file":"UILoader.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["function initRetain(texture) {\n    if (texture.retain == null) {\n        texture.retain = 0;\n    }\n}\n\nfunction initSceneRetain(texture) {\n    if (texture) {\n        if (texture.retain == undefined || texture.retain == null) {\n            texture.retain = 1;\n            return false;\n        } else {\n            return true;\n        }\n    }\n    return false;\n}\n\nfunction parserPrefab(node, number) {\n    // if (!(node instanceof cc.Scene)) {\n    //     parserPrefabNode(node, number);\n    // }\n\n    let children = node._children;\n    children.forEach((child) => {\n        parserPrefabNode(child, number);\n        parserPrefab(child, number);\n    });\n}\n\nfunction parserPrefabNode(node, number) {\n    let sprite = node.getComponent(cc.Sprite);\n    if (sprite && sprite.spriteFrame) {\n        initRetain(cc.loader._cache[sprite.spriteFrame._textureFilename]);\n        cc.loader._cache[sprite.spriteFrame._textureFilename].retain += number;\n    }\n\n    let button = node.getComponent(cc.Button);\n    if (button) {\n        if (button.normalSprite) {\n            initRetain(cc.loader._cache[button.normalSprite._textureFilename]);\n            cc.loader._cache[button.normalSprite._textureFilename].retain += number;\n        }\n\n        if (button.pressedSprite) {\n            initRetain(cc.loader._cache[button.pressedSprite._textureFilename]);\n            cc.loader._cache[button.pressedSprite._textureFilename].retain += number;\n        }\n\n        if (button.hoverSprite) {\n            initRetain(cc.loader._cache[button.hoverSprite._textureFilename]);\n            cc.loader._cache[button.hoverSprite._textureFilename].retain += number;\n        }\n\n        if (button.disabledSprite) {\n            initRetain(cc.loader._cache[button.disabledSprite._textureFilename]);\n            cc.loader._cache[button.disabledSprite._textureFilename].retain += number;\n        }\n    }\n\n    let label = node.getComponent(cc.Label);\n    if (label && label.font && label.font instanceof cc.BitmapFont && label.font.spriteFrame) {\n        initRetain(cc.loader._cache[label.font.spriteFrame._textureFilename]);\n        cc.loader._cache[label.font.spriteFrame._textureFilename].retain += number;\n    }\n\n    let richText = node.getComponent(cc.RichText);\n    if (richText && richText.imageAtlas) {\n        let keys = Object.keys(richText.imageAtlas._spriteFrames);\n        if (keys.length > 0) {\n            initRetain(cc.loader._cache[richText.imageAtlas._spriteFrames[keys[0]]._textureFilename]);\n            cc.loader._cache[richText.imageAtlas._spriteFrames[keys[0]]._textureFilename].retain += number;\n        }\n    }\n\n    let particleSystem = node.getComponent(cc.ParticleSystem);\n    if (particleSystem && particleSystem._texture) {\n        initRetain(cc.loader._cache[particleSystem._texture]);\n        cc.loader._cache[particleSystem._texture].retain += number;\n    }\n\n    let pageViewIndicator = node.getComponent(cc.PageViewIndicator);\n    if (pageViewIndicator && pageViewIndicator.spriteFrame) {\n        initRetain(cc.loader._cache[pageViewIndicator.spriteFrame._textureFilename]);\n        cc.loader._cache[pageViewIndicator.spriteFrame._textureFilename].retain += number;\n    }\n\n    let editBox = node.getComponent(cc.EditBox);\n    if (editBox && editBox.backgroundImage) {\n        initRetain(cc.loader._cache[editBox.backgroundImage._textureFilename]);\n        cc.loader._cache[editBox.backgroundImage._textureFilename].retain += number;\n    }\n\n    let mask = node.getComponent(cc.Mask);\n    if (mask && mask.spriteFrame) {\n        initRetain(cc.loader._cache[mask.spriteFrame._textureFilename]);\n        cc.loader._cache[mask.spriteFrame._textureFilename].retain += number;\n    }\n}\n\nfunction parseStaticRes(item, tag) {\n    if (item instanceof cc.Texture2D) {\n        cc.loader._cache[item.url].isStatic = true;\n        cc.loader._cache[item.url].cusTag = tag;\n    } else if (item instanceof cc.SpriteFrame) {\n        cc.loader._cache[item._textureFilename].isStatic = true;\n        cc.loader._cache[item._textureFilename].cusTag = tag;\n    } else if (item instanceof cc.Prefab) {\n        parseStaticPrefab(item, tag);\n    } else if (item instanceof cc.BitmapFont) {\n        cc.loader._cache[item.spriteFrame._textureFilename].isStatic = true;\n        cc.loader._cache[item.spriteFrame._textureFilename].cusTag = tag;\n    } else if (item instanceof cc.SpriteAtlas) {\n        var keys = Object.keys(item._spriteFrames)\n        keys.forEach((key) => {\n            cc.loader._cache[item._spriteFrames[key]._textureFilename].isStatic = true;\n            cc.loader._cache[item._spriteFrames[key]._textureFilename].cusTag = tag;\n        });\n    } else if (item instanceof cc.AnimationClip) {\n        cc.log('AnimationClip 资源加载未做处理');\n    } else if (item instanceof Object && item.name) {\n        cc.log('Object 资源加载未做处理');\n    }\n}\n\nfunction parseStaticPrefab(node, tag) {\n    var prefab = node;\n    if (node.data) {\n        prefab = node.data;\n    }\n\n    if (!(prefab instanceof cc.Scene)) {\n        parseStaticNode(prefab, tag);\n    }\n    let children = prefab._children;\n    children.forEach((child) => {\n        parseStaticNode(child, tag);\n        parseStaticPrefab(child, tag);\n    });\n}\n\nfunction parseStaticNode(node, tag) {\n    let sprite = node.getComponent(cc.Sprite);\n    if (sprite && sprite.spriteFrame) {\n        if (_isNullObj(cc.loader._cache[sprite.spriteFrame._textureFilename])) {\n            cc.loader._cache[sprite.spriteFrame._textureFilename].isStatic = true;\n            cc.loader._cache[sprite.spriteFrame._textureFilename].cusTag = tag;\n        }\n    }\n\n    let button = node.getComponent(cc.Button);\n    if (button) {\n        if (button.normalSprite) {\n            if (_isNullObj(cc.loader._cache[button.normalSprite._textureFilename])) {\n                cc.loader._cache[button.normalSprite._textureFilename].isStatic = true;\n                cc.loader._cache[button.normalSprite._textureFilename].cusTag = tag;\n            }\n        }\n\n        if (button.pressedSprite) {\n            if (_isNullObj(cc.loader._cache[button.pressedSprite._textureFilename])) {\n                cc.loader._cache[button.pressedSprite._textureFilename].isStatic = true;\n                cc.loader._cache[button.pressedSprite._textureFilename].cusTag = tag;\n            }\n        }\n\n        if (button.hoverSprite) {\n            if (_isNullObj(cc.loader._cache[button.hoverSprite._textureFilename])) {\n                cc.loader._cache[button.hoverSprite._textureFilename].isStatic = true;\n                cc.loader._cache[button.hoverSprite._textureFilename].cusTag = tag;\n            }\n        }\n\n        if (button.disabledSprite) {\n            if (_isNullObj(cc.loader._cache[button.disabledSprite._textureFilename])) {\n                cc.loader._cache[button.disabledSprite._textureFilename].isStatic = true;\n                cc.loader._cache[button.disabledSprite._textureFilename].cusTag = tag;\n            }\n        }\n    }\n\n    let label = node.getComponent(cc.Label);\n    if (label && label.font && label.font instanceof cc.BitmapFont && label.font.spriteFrame) {\n        if (_isNullObj(cc.loader._cache[label.font.spriteFrame._textureFilename])) {\n            cc.loader._cache[label.font.spriteFrame._textureFilename].isStatic = true;\n            cc.loader._cache[label.font.spriteFrame._textureFilename].cusTag = tag;\n        }\n    }\n\n    let richText = node.getComponent(cc.RichText);\n    if (richText && richText.imageAtlas) {\n        let keys = Object.keys(richText.imageAtlas._spriteFrames);\n        if (keys.length > 0) {\n            if (_isNullObj(cc.loader._cache[richText.imageAtlas._spriteFrames[keys[0]]._textureFilename])) {\n                cc.loader._cache[richText.imageAtlas._spriteFrames[keys[0]]._textureFilename].isStatic = true;\n                cc.loader._cache[richText.imageAtlas._spriteFrames[keys[0]]._textureFilename].cusTag = tag;\n            }\n        }\n    }\n\n    let particleSystem = node.getComponent(cc.ParticleSystem);\n    if (particleSystem && particleSystem._texture) {\n        if (_isNullObj(cc.loader._cache[particleSystem._texture])) {\n            cc.loader._cache[particleSystem._texture].isStatic = true;\n            cc.loader._cache[particleSystem._texture].cusTag = tag;\n        }\n    }\n\n    let pageViewIndicator = node.getComponent(cc.PageViewIndicator);\n    if (pageViewIndicator && pageViewIndicator.spriteFrame) {\n        if (_isNullObj(cc.loader._cache[pageViewIndicator.spriteFrame._textureFilename])) {\n            cc.loader._cache[pageViewIndicator.spriteFrame._textureFilename].isStatic = true;\n            cc.loader._cache[pageViewIndicator.spriteFrame._textureFilename].cusTag = tag;\n        }\n    }\n\n    let editBox = node.getComponent(cc.EditBox);\n    if (editBox && editBox.backgroundImage) {\n        if (_isNullObj(cc.loader._cache[editBox.backgroundImage._textureFilename])) {\n            cc.loader._cache[editBox.backgroundImage._textureFilename].isStatic = true;\n            cc.loader._cache[editBox.backgroundImage._textureFilename].cusTag = tag;\n        }\n    }\n\n    let mask = node.getComponent(cc.Mask);\n    if (mask && mask.spriteFrame) {\n        if (_isNullObj(cc.loader._cache[mask.spriteFrame._textureFilename])) {\n            cc.loader._cache[mask.spriteFrame._textureFilename].cusTag = tag;\n            cc.loader._cache[mask.spriteFrame._textureFilename].isStatic = true;\n        }\n    }\n}\n\n\nfunction deepCloneObj(obj) {\n    var i;\n    var o = Array.isArray(obj) ? [] : {};\n    for (i in obj) {\n        if (obj.hasOwnProperty(i)) {\n            o[i] = typeof obj[i] === \"Object\" ? deepCloneObj(obj[i]) : obj[i];\n        }\n    }\n    return o;\n}\n\nfunction releaseNodeRes() {\n\n    var dependAssets = cc.director.getScene().dependAssets;\n\n    var texturesInCache = deepCloneObj(cc.loader._cache);\n\n    var release_key = [];\n\n    for (var asset in texturesInCache) {\n\n        if (texturesInCache[asset].isStatic) {\n            continue;\n        }\n\n        if (texturesInCache[asset].retain <= 0) {\n            release_key.push(texturesInCache[asset].url);\n            cc.loader.release(texturesInCache[asset].url);\n        }\n    }\n\n    releaseRes(release_key);\n    release_key = [];\n}\n\nfunction releaseRes(release_key) {\n    if (release_key && release_key.length > 0) {\n        var release_json = [];\n        for (var asset in cc.loader._cache) {\n            if (cc.loader._cache[asset].dependKeys && cc.loader._cache[asset].dependKeys.length > 0) {\n                var is_release = false;\n                for (var i = 0; i < cc.loader._cache[asset].dependKeys.length; i++) {\n                    if (release_key.indexOf(cc.loader._cache[asset].dependKeys[i]) !== -1) {\n                        is_release = true;\n\n                    }\n                }\n\n                if (is_release) {\n                    release_json.push(cc.loader._cache[asset].url);\n                    cc.loader.release(cc.loader._cache[asset].url);\n                }\n            }\n        }\n\n        if (release_json && release_json.length > 0) {\n            releaseRes(release_json);\n        }\n    }\n}\n\nfunction releaseStaticRes(tag) {\n    var texturesInCache = deepCloneObj(cc.loader._cache);\n\n    var release_key = [];\n\n    for (var asset in texturesInCache) {\n        if (tag) {\n            if (texturesInCache[asset].cusTag != tag) {\n                continue;\n            }\n        }\n\n        if (texturesInCache[asset].retain > 0 && texturesInCache[asset].isStatic) {\n            cc.log(`${asset} 还在使用中..., 该纹理不会释放`);\n            continue;\n        }\n\n        if (texturesInCache[asset].retain <= 0) {\n            release_key.push(texturesInCache[asset].url);\n            cc.loader.release(texturesInCache[asset].url);\n        }\n    }\n\n    var release_json = [];\n\n    for (var asset in cc.loader._cache) {\n        if (cc.loader._cache[asset].dependKeys && cc.loader._cache[asset].dependKeys.length > 0) {\n            var is_release = false;\n            for (var i = 0; i < cc.loader._cache[asset].dependKeys.length; i++) {\n                if (release_key.indexOf(cc.loader._cache[asset].dependKeys[i]) !== -1) {\n                    is_release = true;\n\n                }\n            }\n\n            if (is_release) {\n                release_json.push(cc.loader._cache[asset].url);\n                cc.loader.release(cc.loader._cache[asset].url);\n            }\n        }\n    }\n\n\n    for (var asset in cc.loader._cache) {\n        if (cc.loader._cache[asset].dependKeys && cc.loader._cache[asset].dependKeys.length > 0) {\n            var is_release = false;\n            for (var i = 0; i < cc.loader._cache[asset].dependKeys.length; i++) {\n                if (release_json.indexOf(cc.loader._cache[asset].dependKeys[i]) !== -1) {\n                    is_release = true;\n\n                }\n            }\n\n            if (is_release) {\n                cc.loader.release(cc.loader._cache[asset].url);\n            }\n        }\n    }\n    release_key = [];\n}\n\nfunction replaceButtonTexture(target, normalSprite, newNormalSprite) {\n    if (target[normalSprite]) {\n        initRetain(cc.loader._cache[target[normalSprite]._textureFilename]);\n        cc.loader._cache[target[normalSprite]._textureFilename].retain -= 1;\n    }\n\n    initRetain(cc.loader._cache[newNormalSprite._textureFilename]);\n    cc.loader._cache[newNormalSprite._textureFilename].retain += 1;\n    target[normalSprite] = newNormalSprite;\n}\n\nvar key_map = {};\nvar audioPath = null;\n\nconst UILoader = {\n\n    loadRes(path, type, callback) {\n        cc.loader.loadRes(path, type, (err, asset) => {\n            if (err) {\n                cc.log(`[资源加载] 错误 ${err}`);\n                return;\n            }\n            callback(asset)\n        });\n    },\n\n\n    loadStaticRes(path, type, tag, callback) {\n        if (!path || !type || !callback) {\n            cc.log(\"参数错误\");\n            return;\n        }\n        cc.loader.loadRes(path, type, (err, asset) => {\n            if (err) {\n                cc.log(`[资源加载] 错误 ${err}`);\n                return;\n            }\n            callback(asset)\n            parseStaticRes(asset, tag);\n        });\n    },\n\n\n    retainScene(scene) {\n        parserPrefab(scene, 1);\n    },\n\n    replaceSpriteTexture(target, spriteFrame) {\n        if (!target || !spriteFrame) {\n            cc.log(\"参数错误\")\n            return;\n        }\n\n        if (!target.getComponent(cc.Sprite)) {\n            cc.log(\"目标节点没有Sprite组件\");\n            return;\n        }\n\n        let sprite = target.getComponent(cc.Sprite);\n\n        replaceButtonTexture(sprite, \"spriteFrame\", spriteFrame);\n\n        releaseNodeRes();\n    },\n\n    replaceButtonTexture(target, normalSprite, pressedSprite, hoverSprite, disabledSprite) {\n        if (!target || !normalSprite) {\n            cc.log(\"参数错误\")\n            return;\n        }\n\n        if (!target.getComponent(cc.Button)) {\n            cc.log(\"目标节点没有Button组件\");\n            return;\n        }\n\n        let button = target.getComponent(cc.Button);\n        if (normalSprite) {\n            replaceButtonTexture(button, \"normalSprite\", normalSprite);\n        }\n\n        if (pressedSprite) {\n            replaceButtonTexture(button, \"pressedSprite\", pressedSprite);\n        }\n\n        if (hoverSprite) {\n            replaceButtonTexture(button, \"hoverSprite\", hoverSprite);\n        }\n\n        if (disabledSprite) {\n            replaceButtonTexture(button, \"disabledSprite\", disabledSprite);\n        }\n\n        releaseNodeRes();\n    },\n\n    instantiate(prefab, target, callback) {\n        if (!target || !callback) {\n            cc.log(\"参数不对, 请检查参数\");\n        }\n        let node_prefab = cc.instantiate(prefab);\n        target.addChild(node_prefab);\n        callback(node_prefab);\n        parserPrefab(node_prefab, 1);\n    },\n\n    releaseStaticRes(tag) {\n        releaseStaticRes(tag);\n    },\n\n    destroy(node) {\n        if (!node instanceof cc.Node) {\n            cc.log(\"你要销毁的不是一个节点\");\n            return;\n        }\n        parserPrefab(node, -1);\n        node.destroy();\n        releaseNodeRes();\n    },\n\n    beforeSceneLoading(event, detail) {\n        key_map = {};\n        var dependAssets = event.currentTarget._scene.dependAssets;\n        if (dependAssets && dependAssets.length > 0) {\n            for (var i = 0; i < dependAssets.length; i++) {\n                if (cc.loader._cache[dependAssets[i]] && cc.loader._cache[dependAssets[i]].isStatic) {\n                    key_map[i] = dependAssets[i];\n                    delete dependAssets[i];\n                }\n\n                if (initSceneRetain(cc.loader._cache[dependAssets[i]])) {\n                    cc.loader._cache[dependAssets[i]].retain -= 1;\n                }\n            }\n        }\n\n        var keys = Object.keys(cc.loader._cache);\n        keys.forEach((key) => {\n            if (cc.loader._cache[key] && !cc.loader._cache[key].isStatic && cc.loader._cache[key].retain > 0) {\n                if (initSceneRetain(cc.loader._cache[key])) {\n                    cc.loader._cache[key].retain = 0;\n                }\n            }\n        });\n    },\n\n    afterSceneLaunch(event, detail) {\n        for (var key in key_map) {\n            event.currentTarget._scene.dependAssets[key] = key_map[key];\n        }\n        var dependAssets = event.currentTarget._scene.dependAssets;\n        if (dependAssets && dependAssets.length > 0) {\n            for (var i = dependAssets.length - 1; i >= 0; i--) {\n                if (cc.loader._cache[dependAssets[i]] && cc.loader._cache[dependAssets[i]].isStatic) {\n                    continue;\n                }\n                if (initSceneRetain(cc.loader._cache[dependAssets[i]])) {\n                    cc.loader._cache[dependAssets[i]].retain += 1;\n                }\n\n            }\n        }\n        releaseNodeRes();\n    },\n\n    playEffect(path, volume) {\n        if (!path || !volume) {\n            cc.log(\"参数错误\");\n            return;\n        }\n        let audioID = cc.audioEngine.play(path, false, volume);\n        cc.audioEngine.setFinishCallback(audioID, (ss, ss11) => {\n            cc.loader.release(cc.loader._cache[ss.target.src].url);\n        });\n        return audioID;\n    },\n\n    playMusic(path, loop, volume) {\n        if (!path || !volume) {\n            cc.log(\"参数错误\");\n            return;\n        }\n        if (audioPath) {\n            cc.loader.release(cc.loader._cache[audioPath].url);\n        }\n        audioPath = path;\n        let audioID = cc.audioEngine.playMusic(path, loop, volume);\n        cc.audioEngine.setFinishCallback(audioID, (ss, ss11) => {\n            cc.log(\"触发回调函数\");\n            cc.loader.release(cc.loader._cache[ss.target.src].url);\n        });\n        return audioID;\n    }\n\n\n};\n\nmodule.exports = UILoader;\n"]}